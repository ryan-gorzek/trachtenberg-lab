theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass, fill = subclass)) +
geom_density(
size = 1,
alpha = 0.3,       # Transparency for overlapping fills
adjust = 0.1         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass, fill = subclass)) +
geom_density(
size = 1,
alpha = 0.3,       # Transparency for overlapping fills
adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass, fill = subclass, linetype = 2)) +
geom_density(
size = 1,
alpha = 0.3,       # Transparency for overlapping fills
adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass, fill = subclass)) +
geom_density(
size = 1,
adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 1,
adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
color = subclass,
size = 1,
adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
# size = 1,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = colors_list) +
scale_fill_manual(values = colors_list) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
df
df$subclass
colors_list[c("L2/3", "L4")]
colors_list[[c("L2/3", "L4")]]
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$y,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
# size = 1,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list[subclass_order])) +
scale_fill_manual(values = as.character(colors_list[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
# size = 1,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list[subclass_order])) +
scale_fill_manual(values = as.character(colors_list[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list[subclass_order])) +
scale_fill_manual(values = as.character(colors_list[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list[subclass_order])) +
scale_fill_manual(values = as.character(colors_list[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
)
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list[subclass_order])) +
scale_fill_manual(values = as.character(colors_list[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank()
) + coord_flip()
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list[subclass_order])) +
scale_fill_manual(values = as.character(colors_list[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank(),
aspect.ratio = 1
) + coord_flip()
colors_list_density <- list(`L2/3` = "#FF6C88",
L4 = "#1E90FF",
L5IT = "#FF4500",
L6IT = "#f7f023",
L5NP = "#de23f7",
L5PT = "#128e27",
L6CT = "#23cdf7",
L6b = "#f77b23")
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list_density[subclass_order])) +
scale_fill_manual(values = as.character(colors_list_density[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank(),
aspect.ratio = 1
) + coord_flip()
colors_list_density <- list(`L2/3` = "#FF6C88",
L4 = "#1E90FF",
L5IT = "#FF4500",
L6IT = "#f7f023",
L5NP = "#de23f7",
L5PT = "#128e27",
L6CT = "#23cdf7",
L6b = "#f77b23")
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
df <- df[is.na(df$subclass),]
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list_density[subclass_order])) +
scale_fill_manual(values = as.character(colors_list_density[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank(),
aspect.ratio = 1
) + coord_flip()
colors_list_density <- list(`L2/3` = "#FF6C88",
L4 = "#1E90FF",
L5IT = "#FF4500",
L6IT = "#f7f023",
L5NP = "#de23f7",
L5PT = "#128e27",
L6CT = "#23cdf7",
L6b = "#f77b23")
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
df <- df[!is.na(df$subclass),]
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass)) %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list_density[subclass_order])) +
scale_fill_manual(values = as.character(colors_list_density[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank(),
aspect.ratio = 1
) + coord_flip()
is.na(df$subclass)
colors_list_density <- list(`L2/3` = "#FF6C88",
L4 = "#1E90FF",
L5IT = "#FF4500",
L6IT = "#f7f023",
L5NP = "#de23f7",
L5PT = "#128e27",
L6CT = "#23cdf7",
L6b = "#f77b23")
# 2. Extract coordinates and subclass labels
coords <- GetTissueCoordinates(obj.ctx.glutamatergic.COL)
df <- data.frame(
y = coords$x,
subclass = obj.ctx.glutamatergic.COL$subclass_nn
)
# 3. Filter and set subclass as a factor to enforce order
df <- df %>%
filter(!is.na(subclass) & subclass != "None") %>%
mutate(subclass = factor(subclass, levels = subclass_order))
# 4. Plot smooth density profiles
ggplot(df, aes(x = y, color = subclass)) +
geom_density(
size = 2,
# adjust = 0.2         # Smoothing factor (increase if you want smoother lines)
) +
scale_color_manual(values = as.character(colors_list_density[subclass_order])) +
scale_fill_manual(values = as.character(colors_list_density[subclass_order])) +
labs(
title = "Smooth density profiles of subclasses along the Y-axis",
x = "Y-axis position",
y = "Density"
) +
theme_minimal() +
theme(
legend.title = element_blank(),
aspect.ratio = 1
) + coord_flip()
gc()
obj.ctx <- readRDS("E:/STOmics/seurat/opossum_stereoseq_ctx_1.rds")

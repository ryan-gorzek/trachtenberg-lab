---
title: "R Notebook"
output: html_notebook
---


```{r}

# crops <- list(theta = c(-5, -7, -38), 
#               x1 = c(-9500, -7000, -125), 
#               x2 = c(-7500, -5000, 1045), 
#               y1 = c(-14300, -14600, -5650), 
#               y2 = c(-12800, -13050, -7000))

areas.opossum <- c((9500-7500)*(14300-12800), (7000-5000)*(14600-13050), (1045+125)*(7000-5650))
counts.opossum.od <- c(253, 285, 110)
counts.opossum.pv <- c(96, 91, 42)

# crops <- list(theta = c(45, 10, -8, -30), 
#               x1 = c(-19450, -17500, -7650, -1700), 
#               x2 = c(-17000, -16300, -6250, -250), 
#               y1 = c(950, -3800, -6850, -14100), 
#               y2 = c(2500, -2400, -5600, -12700))

areas.mouse <- c((19450-17000)*(2500-950), (17500-16300)*(3800-2400), (7650-6250)*(6850-5600), (1700-250)*(14100-12700))
counts.mouse.od <- c(375, 107, 173, 197)
counts.mouse.pv <- c(111, 34, 47, 59)

# Compute densities
densities.opossum <- (counts.opossum.od / areas.opossum) * 10000
densities.mouse <- (counts.mouse.od / areas.mouse) * 10000

# Combine into one dataframe
df <- data.frame(
  species = rep(c("Opossum", "Mouse"), times = c(length(densities.opossum), length(densities.mouse))),
  density = c(densities.opossum, densities.mouse)
)

# Plot
ggplot(df, aes(x = species, y = density, fill = species)) +
  stat_summary(fun = mean, geom = "bar", width = 0.6, color = "black") +
  stat_summary(fun.data = mean_se, geom = "errorbar", width = 0.2) +
  geom_jitter(width = 0.15, size = 3, shape = 21, stroke = 1.2, aes(fill = species)) +
  scale_fill_manual(values = c("Opossum" = "#6baed6", "Mouse" = "#fd8d3c")) +
  labs(y = "PV Cell Density (per 10,000 µm²)", x = NULL,
       title = "PV Cell Density: Opossum vs Mouse") +
  theme_classic(base_size = 14) +
  theme(legend.position = "none")

# (counts.opossum.pv / areas.opossum) * 10000
# (counts.mouse.pv / areas.mouse) * 10000

```
